function createVisitCardiologist(e,t,s,i,o,a,n,l,r,d,c){fetch("https://ajax.test-danit.com/api/v2/cards",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${token}`},body:JSON.stringify({doctor:e,pressure:t,bmi:s,diseases:i,age:o,goal:a,description:n,priority:l,visitor:r,dateTime:d,status:c})}).then((e=>e.json())).then((e=>{console.log(e);new VisitCardCardiologist(e).render()}))}function createVisitDentist(e,t,s,i,o,a,n,l){fetch("https://ajax.test-danit.com/api/v2/cards",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${token}`},body:JSON.stringify({doctor:e,lastVisit:t,goal:s,description:i,priority:o,visitor:a,dateTime:n,status:l})}).then((e=>e.json())).then((e=>{console.log(e);new VisitCardDentist(e).render()}))}function createVisitTherapist(e,t,s,i,o,a,n,l){fetch("https://ajax.test-danit.com/api/v2/cards",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${token}`},body:JSON.stringify({doctor:e,age:t,goal:s,description:i,priority:o,visitor:a,dateTime:n,status:l})}).then((e=>e.json())).then((e=>{console.log(e);new VisitCardTherapist(e).render()}))}function deleteCard(e){fetch(`https://ajax.test-danit.com/api/v2/cards/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${token}`}})}function editVisit(e,t){fetch(`https://ajax.test-danit.com/api/v2/cards/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${token}`},body:JSON.stringify(e)}).then((()=>{closeModal(),getVisits()}))}function filterVisits(){const e=document.querySelector("#status").value,t=document.querySelector("#priority").value,s=document.querySelector("#patient").value;let i,o,a;visits.innerHTML="",fetch("https://ajax.test-danit.com/api/v2/cards",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${token}`}}).then((e=>e.json())).then((n=>{i="all"==e?n:n.filter((t=>t.status==e)),o="all"==t?i:i.filter((e=>e.priority==t)),a=""==s?o:o.filter((e=>e.visitor.includes(s))),0==a.length?visits.innerHTML="<h2>Немає візитів, що відповідають заданим критеріям</h2>":a.forEach((e=>renderVisit(e,e.doctor)))}))}document.querySelector("#btnFilter").addEventListener("click",filterVisits);const enterButton=document.getElementById("enterButton"),formElement=document.querySelector(".form-autoris form"),overlayElement=document.querySelector(".overlay");enterButton.addEventListener("click",(function(){formElement.style.display="block",overlayElement.style.display="block"})),overlayElement.addEventListener("click",(function(e){e.target===overlayElement&&(formElement.style.display="none",overlayElement.style.display="none")}));const mainField=document.getElementById("mainField"),createButton=document.getElementById("createButton"),exitButton=document.getElementById("exitButton"),helloWindow=document.getElementById("helloWindow"),token="c5dbf986-2bf0-4d36-80bd-13cbea71b9e8";formElement.addEventListener("submit",(function(e){e.preventDefault();const t=formElement.querySelector('input[name="login"]'),s=formElement.querySelector('input[name="password"]');"felangelena@gmail.com"===t.value&&"danIT"===s.value?(localStorage.setItem("token",token),enterButton.style.display="none",formElement.style.display="none",overlayElement.style.display="none",helloWindow.style.display="none",createButton.style.display="block",exitButton.style.display="block",mainField.style.display="flex"):alert("Ошибка: неправильний логін або пароль")})),exitButton.addEventListener("click",(function(){localStorage.removeItem("token"),enterButton.style.display="block",helloWindow.style.display="flex",formElement.style.display="none",createButton.style.display="none",exitButton.style.display="none",mainField.style.display="none"})),localStorage.getItem("token")&&(enterButton.style.display="none",formElement.style.display="none",overlayElement.style.display="none",helloWindow.style.display="none",createButton.style.display="block",exitButton.style.display="block",mainField.style.display="flex"),overlayElement.addEventListener("click",(function(e){e.target===overlayElement&&(formElement.style.display="none",overlayElement.style.display="none")}));const overlay=document.getElementById("overlay");createButton.addEventListener("click",(function(){formElement.classList.add("Modal"),overlay.style.display="block",formElement.style.display="flex"})),createButton.addEventListener("click",(function(){formElement.style.display="block"}));const doctorSelect=document.querySelector(".doctor-select"),metaInput=document.createElement("input");metaInput.type="text",metaInput.classList.add("form-control"),metaInput.setAttribute("id","goal"),metaInput.placeholder="Мета візиту",metaInput.required=!0;const descriptionInput=document.createElement("input");descriptionInput.type="text",descriptionInput.classList.add("form-control"),descriptionInput.setAttribute("id","description"),descriptionInput.placeholder="Короткий опис візиту",descriptionInput.required=!0;const urgencySelect=document.createElement("select");urgencySelect.classList.add("form-control"),urgencySelect.setAttribute("id","priority"),urgencySelect.innerHTML='\n    <option value="low">Звичайна</option>\n    <option value="normal">Пріоритетна</option>\n    <option value="high">Невідкладна</option>\n';const statusSelect=document.createElement("select");statusSelect.classList.add("form-control"),statusSelect.setAttribute("id","status"),statusSelect.innerHTML='\n    <option value="planned">Запланований</option>\n    <option value="visited">Відбувся</option>\n';const fullNameInput=document.createElement("input");fullNameInput.type="text",fullNameInput.classList.add("form-control"),fullNameInput.setAttribute("id","visitor"),fullNameInput.placeholder="ПІБ",fullNameInput.required=!0;const dateInputLabel=document.createElement("label");dateInputLabel.textContent="Дата і час візиту",dateInputLabel.classList.add("input-label");const dateInput=document.createElement("input");dateInput.type="datetime-local",dateInput.classList.add("form-control"),dateInput.setAttribute("id","dateTime"),dateInput.required=!0;const createCardButton=document.createElement("button");createCardButton.type="submit",createCardButton.classList.add("btn","btn-sm"),createCardButton.id="addCardSubmitButton",createCardButton.textContent="Створити";const editBtn=document.createElement("button");editBtn.type="button",editBtn.classList.add("btn","btn-sm","btn-edit"),editBtn.id="editBtn",editBtn.textContent="Записати зміни";const closeButton=document.createElement("button");function openModal(){formElement.classList.add("Modal"),overlay.style.display="block",formElement.style.display="flex";formElement.querySelectorAll(".form-group").forEach((e=>{e.style.display="none"})),doctorSelect.style.display="block",extraFieldsContainer.style.display="block",formElement.appendChild(metaInput),formElement.appendChild(descriptionInput),formElement.appendChild(urgencySelect),formElement.appendChild(fullNameInput),formElement.appendChild(dateInputLabel),formElement.appendChild(dateInput),formElement.appendChild(statusSelect),formElement.appendChild(createCardButton),formElement.appendChild(editBtn),formElement.appendChild(closeButton)}function closeModal(){formElement.reset(),formElement.classList.remove("Modal"),overlay.style.display="none",formElement.style.display="none",dateInput.value="",metaInput.value="",descriptionInput.value="",urgencySelect.value="normal",fullNameInput.value="",extraFieldsContainer.innerHTML="";formElement.querySelectorAll(".form-group").forEach((e=>{e.style.display="block"})),doctorSelect.style.display="none",extraFieldsContainer.style.display="none",formElement.removeChild(dateInput),formElement.removeChild(metaInput),formElement.removeChild(descriptionInput),formElement.removeChild(urgencySelect),formElement.removeChild(fullNameInput),formElement.removeChild(createCardButton),formElement.removeChild(editBtn),formElement.removeChild(closeButton),formElement.removeChild(dateInputLabel)}closeButton.type="button",closeButton.classList.add("btn","btn-sm"),closeButton.id="ExitAddCardButton",closeButton.textContent="Закрити",createButton.addEventListener("click",(function(e){e.preventDefault(),openModal()})),closeButton.addEventListener("click",closeModal),exitButton.addEventListener("click",closeModal),overlay.addEventListener("click",closeModal);const extraFieldsContainer=document.querySelector(".extra-fields-container");function applyDoctorClass(e){formElement.classList.remove("VisitDentist","VisitCardiologist","VisitTherapist"),formElement.classList.add(e),extraFieldsContainer.innerHTML=""}function changeDoctor(e){switch(e){case"Dentist":applyDoctorClass("VisitDentist"),addDentistFields();break;case"Cardiologist":applyDoctorClass("VisitCardiologist"),addCardiologistFields();break;case"Therapist":applyDoctorClass("VisitTherapist"),addTherapistFields();break;default:applyDoctorClass(""),extraFieldsContainer.innerHTML=""}}function addDentistFields(){const e=document.createElement("label");e.textContent="Дата останнього візиту",e.classList.add("input-label");const t=document.createElement("input");t.type="date",t.classList.add("form-control"),t.setAttribute("id","lastVisit"),t.required=!0,extraFieldsContainer.appendChild(e),extraFieldsContainer.appendChild(t)}function addCardiologistFields(){const e=document.createElement("input");e.type="text",e.classList.add("form-control"),e.setAttribute("id","bloodPressure"),e.placeholder="Звичайний тиск",e.required=!0,extraFieldsContainer.appendChild(e);const t=document.createElement("input");t.type="text",t.classList.add("form-control"),t.setAttribute("id","bmi"),t.placeholder="Індекс маси тіла",t.required=!0,extraFieldsContainer.appendChild(t);const s=document.createElement("input");s.type="text",s.classList.add("form-control"),s.setAttribute("id","diseases"),s.placeholder="Перенесені захворювання ССС",s.required=!0,extraFieldsContainer.appendChild(s);const i=document.createElement("input");i.type="text",i.classList.add("form-control"),i.setAttribute("id","age"),i.placeholder="Вік",i.required=!0,i.addEventListener("input",(function(){const e=i.value;/^[1-9][0-9]?$|^120$/.test(e)?i.setCustomValidity(""):i.setCustomValidity("Введіть коректне значення віку (від 1 до 120)")})),extraFieldsContainer.appendChild(i)}function addTherapistFields(){const e=document.createElement("input");e.type="text",e.classList.add("form-control"),e.setAttribute("id","years"),e.placeholder="Вік",e.required=!0,e.addEventListener("input",(function(){const t=e.value;/^[1-9][0-9]?$|^120$/.test(t)?e.setCustomValidity(""):e.setCustomValidity("Введіть коректне значення віку (від 1 до 120)")})),extraFieldsContainer.appendChild(e)}doctorSelect.addEventListener("change",(()=>{changeDoctor(doctorSelect.value)})),createCardButton.addEventListener("click",(function(e){if(formElement.classList.contains("Modal")&&""===doctorSelect.value)e.preventDefault(),alert("Выберите врача");else switch(doctorSelect.value){case"Dentist":createVisitDentist(doctorSelect.value,document.querySelector("#lastVisit").value,document.querySelector("#goal").value,document.querySelector("#description").value,document.querySelector("#priority").value,document.querySelector("#visitor").value,document.querySelector("#dateTime").value,document.querySelector("#status").value);break;case"Cardiologist":createVisitCardiologist(doctorSelect.value,document.querySelector("#bloodPressure").value,document.querySelector("#bmi").value,document.querySelector("#diseases").value,document.querySelector("#age").value,document.querySelector("#goal").value,document.querySelector("#description").value,document.querySelector("#priority").value,document.querySelector("#visitor").value,document.querySelector("#dateTime").value,document.querySelector("#status").value);break;case"Therapist":createVisitTherapist(doctorSelect.value,document.querySelector("#years").value,document.querySelector("#goal").value,document.querySelector("#description").value,document.querySelector("#priority").value,document.querySelector("#visitor").value,document.querySelector("#dateTime").value,document.querySelector("#status").value)}})),window.onload=e=>{getVisits()};class VisitCardDentist{constructor({id:e,visitor:t,doctor:s,priority:i,dateTime:o,goal:a,description:n,lastVisit:l,status:r}){this.id=e,this.visitor=t,this.doctor=s,this.priority=i,this.dateTime=o,this.status=r,this.goal=a,this.description=n,this.lastVisit=l}render(){const e=document.createElement("div");e.classList.add("card"),e.dataset.id=this.id;const t=new Date(this.dateTime),s=("00"+t.getDate()).slice(-2)+"."+("00"+(t.getMonth()+1)).slice(-2)+"."+t.getFullYear()+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2),i=new Date(this.lastVisit),o=("00"+i.getDate()).slice(-2)+"."+("00"+(i.getMonth()+1)).slice(-2)+"."+i.getFullYear();e.innerHTML=`\n        <div class="card-header">\n        <h5 class="card-title">Карта візиту</h5>\n        <div class="card-header-btns">\n            <button type="button" class="btn btn-primary btn--edit">Редагувати</button>\n            <button type="button" class="btn btn-primary btn--delete" title="Видалити">X</button>\n        </div>\n        </div>\n        <div class="card-body">\n            <h6 class="title">ПІБ:</h6>\n            <p class="desc" data-visitor="${this.visitor}">${this.visitor}</p>\n            <h6 class="title">Лікар:</h6>\n            <p class="desc" data-doctor="${this.doctor}">${this.doctor}</p>\n            <button type="button" class="btn btn-primary seeMore">Показати більше</button>\n            <div class="card-body-hide hide">\n                <h6 class="title">Терміновість:</h6>\n                <p class="desc" data-priority="${this.priority}">${this.priority}</p>\n                <h6 class="title">Дата і час:</h6>\n                <p class="desc" data-date="${this.dateTime}">${s}</p>\n                <h6 class="title">Статус візиту:</h6>\n                <p class="desc" data-status="${this.status}">${this.status}</p>\n                <h6 class="title">Мета візиту:</h6>\n                <p class="desc" data-goal="${this.goal}">${this.goal}</p>\n                <h6 class="title">Опис візиту:</h6>\n                <p class="desc" data-description="${this.description}">${this.description}</p>\n                <h6 class="title">Дата останнього візиту:</h6>\n                <p class="desc" data-last="${this.lastVisit}">${o}</p>\n            </div>\n        </div>\n        `,document.querySelector(".visits").prepend(e)}}class VisitCardCardiologist{constructor({id:e,visitor:t,doctor:s,priority:i,dateTime:o,goal:a,description:n,pressure:l,bmi:r,diseases:d,age:c,status:u}){this.id=e,this.visitor=t,this.doctor=s,this.priority=i,this.dateTime=o,this.status=u,this.goal=a,this.description=n,this.pressure=l,this.bmi=r,this.diseases=d,this.age=c}render(){const e=document.createElement("div");e.classList.add("card"),e.dataset.id=this.id;const t=new Date(this.dateTime),s=("00"+t.getDate()).slice(-2)+"."+("00"+(t.getMonth()+1)).slice(-2)+"."+t.getFullYear()+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2);e.innerHTML=`\n        <div class="card-header">\n        <h5 class="card-title">Карта візиту</h5>\n        <div class="card-header-btns">\n            <button type="button" class="btn btn-primary btn--edit">Редагувати</button>\n            <button type="button" class="btn btn-primary btn--delete" title="Видалити">X</button>\n        </div>\n        </div>\n        <div class="card-body">\n            <h6 class="title">ПІБ:</h6>\n            <p class="desc" data-visitor="${this.visitor}">${this.visitor}</p>\n            <h6 class="title">Лікар:</h6>\n            <p class="desc" data-doctor="${this.doctor}">${this.doctor}</p>\n            <button type="button" class="btn btn-primary seeMore">Показати більше</button>\n            <div class="card-body-hide hide">\n                <h6 class="title">Терміновість:</h6>\n                <p class="desc" data-priority="${this.priority}">${this.priority}</p>\n                <h6 class="title">Дата і час:</h6>\n                <p class="desc" data-date="${this.dateTime}">${s}</p>\n                <h6 class="title">Статус візиту:</h6>\n                <p class="desc" data-status="${this.status}">${this.status}</p>\n                <h6 class="title">Мета візиту:</h6>\n                <p class="desc" data-goal="${this.goal}">${this.goal}</p>\n                <h6 class="title">Опис візиту:</h6>\n                <p class="desc" data-description="${this.description}">${this.description}</p>\n                <h6 class="title">Звичайний тиск:</h6>\n                <p class="desc" data-pressure="${this.pressure}">${this.pressure}</p>\n                <h6 class="title">Індекс маси тіла:</h6>\n                <p class="desc" data-bmi="${this.bmi}">${this.bmi}</p>\n                <h6 class="title">Перенесені захворювання серцево-судинної системи:</h6>\n                <p class="desc" data-diseases="${this.diseases}">${this.diseases}</p>\n                <h6 class="title">Вік:</h6>\n                <p class="desc" data-age="${this.age}">${this.age}</p>\n            </div>\n        </div>\n        `,document.querySelector(".visits").prepend(e)}}class VisitCardTherapist{constructor({id:e,visitor:t,doctor:s,priority:i,dateTime:o,goal:a,description:n,age:l,status:r}){this.id=e,this.visitor=t,this.doctor=s,this.priority=i,this.dateTime=o,this.status=r,this.goal=a,this.description=n,this.age=l}render(){const e=document.createElement("div");e.classList.add("card"),e.dataset.id=this.id;const t=new Date(this.dateTime),s=("00"+t.getDate()).slice(-2)+"."+("00"+(t.getMonth()+1)).slice(-2)+"."+t.getFullYear()+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2);e.innerHTML=`\n        <div class="card-header">\n        <h5 class="card-title">Карта візиту</h5>\n        <div class="card-header-btns">\n            <button type="button" class="btn btn-primary btn--edit">Редагувати</button>\n            <button type="button" class="btn btn-primary btn--delete" title="Видалити">X</button>\n        </div>\n        </div>\n        <div class="card-body">\n            <h6 class="title">ПІБ:</h6>\n            <p class="desc" data-visitor="${this.visitor}">${this.visitor}</p>\n            <h6 class="title">Лікар:</h6>\n            <p class="desc" data-doctor="${this.doctor}">${this.doctor}</p>\n            <button type="button" class="btn btn-primary seeMore">Показати більше</button>\n            <div class="card-body-hide hide">\n                <h6 class="title">Терміновість:</h6>\n                <p class="desc" data-priority="${this.priority}">${this.priority}</p>\n                <h6 class="title">Дата і час:</h6>\n                <p class="desc" data-date="${this.dateTime}">${s}</p>\n                <h6 class="title">Статус візиту:</h6>\n                <p class="desc" data-status="${this.status}">${this.status}</p>\n                <h6 class="title">Мета візиту:</h6>\n                <p class="desc" data-goal="${this.goal}">${this.goal}</p>\n                <h6 class="title">Опис візиту:</h6>\n                <p class="desc" data-description="${this.description}">${this.description}</p>\n                <h6 class="title">Вік:</h6>\n                <p class="desc" data-years="${this.age}">${this.age}</p>\n            </div>\n        </div>\n        `,document.querySelector(".visits").prepend(e)}}const visits=document.querySelector(".visits");function getVisits(){visits.innerHTML="",fetch("https://ajax.test-danit.com/api/v2/cards",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${token}`}}).then((e=>e.json())).then((e=>{console.log(e),0==e.length?visits.innerHTML="<h2>No items have been added</h2>":e.forEach((e=>renderVisit(e,e.doctor)))}))}function renderVisit(e,t){switch(t){case"Cardiologist":new VisitCardCardiologist(e).render();break;case"Dentist":new VisitCardDentist(e).render();break;case"Therapist":new VisitCardTherapist(e).render()}}function seeMore(e){e.nextElementSibling.classList.toggle("hide"),"Показати більше"==e.textContent?e.textContent="Приховати":e.textContent="Показати більше"}function deleteCard(e){const t=e.closest("div.card").getAttribute("data-id");console.log(t),deleteCard(t),e.closest("div.card").remove()}function editCard(e){formElement.classList.add("Modal"),overlay.style.display="block",openModal(),document.querySelector("#addCardSubmitButton").style.display="none";const t=document.querySelector("#editBtn");t.style.display="block";const s=e.closest("div.card");let i=s.getAttribute("data-id");const o=s.querySelector("[data-doctor]").dataset.doctor,a=s.querySelector("[data-visitor]").dataset.visitor,n=s.querySelector("[data-goal]").dataset.goal,l=s.querySelector("[data-description]").dataset.description,r=s.querySelector("[data-priority]").dataset.priority,d=s.querySelector("[data-status]").dataset.status,c=s.querySelector("[data-date]").dataset.date;switch(changeDoctor(o),doctorSelect.value=o,document.querySelector("#visitor").value=a,document.querySelector("#goal").value=n,document.querySelector("#description").value=l,document.querySelector("#priority").value=r,document.querySelector("#status").value=d,document.querySelector("#dateTime").value=c,o){case"Dentist":const e=s.querySelector("[data-last]").dataset.last;document.querySelector("#lastVisit").value=e;break;case"Cardiologist":console.log("Luck");const t=s.querySelector("[data-pressure]").dataset.pressure;document.querySelector("#bloodPressure").value=t;const i=s.querySelector("[data-bmi]").dataset.bmi;document.querySelector("#bmi").value=i;const o=s.querySelector("[data-diseases]").dataset.diseases;document.querySelector("#diseases").value=o;const a=s.querySelector("[data-age]").dataset.age;document.querySelector("#age").value=a;break;case"Therapist":const n=s.querySelector("[data-years]").dataset.years;document.querySelector("#years").value=n}t.addEventListener("click",(()=>{let e;switch(o){case"Dentist":e={id:i,visitor:document.querySelector("#visitor").value,doctor:doctorSelect.value,priority:document.querySelector("#priority").value,dateTime:document.querySelector("#dateTime").value,status:document.querySelector("#status").value,goal:document.querySelector("#goal").value,description:document.querySelector("#description").value,lastVisit:document.querySelector("#lastVisit").value};break;case"Cardiologist":e={id:i,visitor:document.querySelector("#visitor").value,doctor:doctorSelect.value,priority:document.querySelector("#priority").value,dateTime:document.querySelector("#dateTime").value,status:document.querySelector("#status").value,goal:document.querySelector("#goal").value,description:document.querySelector("#description").value,pressure:document.querySelector("#bloodPressure").value,bmi:document.querySelector("#bmi").value,diseases:document.querySelector("#diseases").value,age:document.querySelector("#age").value};break;case"Therapist":e={id:i,visitor:document.querySelector("#visitor").value,doctor:doctorSelect.value,priority:document.querySelector("#priority").value,dateTime:document.querySelector("#dateTime").value,status:document.querySelector("#status").value,goal:document.querySelector("#goal").value,description:document.querySelector("#description").value,age:document.querySelector("#years").value}}editVisit(e,i)}))}visits.addEventListener("click",(e=>{const t=e.target;t.classList.contains("seeMore")?seeMore(t):t.classList.contains("btn--delete")?deleteCard(t):t.classList.contains("btn--edit")&&editCard(t)}));